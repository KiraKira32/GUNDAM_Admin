import{D as U,T as k,M as f,a as N}from"./ToastMessages-316c05de.js";import{P as V}from"./PaginationComponent-b3ada9b3.js";import{_ as v,o as i,c as d,a as t,b as r,v as u,F as g,h as P,i as C,j as L,f as D,r as h,d as p,t as _}from"./index-e1d3104f.js";const S={props:["tempProduct","isNew"],data(){return{product:{}}},emits:["update-product"]},T={class:"modal fade",id:"productModal",ref:"productModal",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},$={class:"modal-dialog modal-xl"},A={class:"modal-content border-0"},B={class:"modal-header bg-dark text-white"},E={class:"modal-title",id:"productModalLabel"},F={key:0},I={key:1},j=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),z={class:"modal-body"},q={class:"row"},G={class:"col-sm-4"},H={class:"mb-2"},J={class:"mb-3"},K=t("label",{for:"imageUrl",class:"form-label"},"新增圖片網址",-1),O=["src"],Q=t("hr",null,null,-1),R=t("h5",{class:"mb-4 mt-4"},"商品多圖設置",-1),W={key:0},X=["onUpdate:modelValue"],Y=["src"],Z=t("hr",null,null,-1),tt={class:"col-sm-8"},et={class:"mb-3"},st=t("label",{for:"title",class:"form-label"},"標題",-1),ot={class:"row"},lt={class:"mb-3 col-md-6"},it=t("label",{for:"category",class:"form-label"},"類別",-1),dt={class:"mb-3 col-md-6"},at=t("label",{for:"unit",class:"form-label"},"單位",-1),nt={class:"row"},ct={class:"mb-3 col-md-6"},rt=t("label",{for:"origin_price",class:"form-label"},"原價",-1),ut={class:"mb-3 col-md-6"},mt=t("label",{for:"price",class:"form-label"},"售價",-1),ht=D('<hr><div class="mb-3"><label for="description" class="form-label">產品描述</label><textarea id="description" type="text" class="form-control" placeholder="請輸入產品描述"></textarea></div><div class="mb-3"><label for="content" class="form-label">說明內容</label><textarea id="content" type="text" class="form-control" placeholder="請輸入說明內容"></textarea></div>',3),pt={class:"mb-3"},_t={class:"form-check"},bt=t("label",{for:"is_enabled",class:"form-check-label"},"是否上架商品",-1),gt={class:"modal-footer"},ft=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function vt(l,e,s,y,a,c){return i(),d("div",null,[t("div",T,[t("div",$,[t("div",A,[t("div",B,[t("h5",E,[s.isNew?(i(),d("span",F,"新增產品")):(i(),d("span",I,"編輯產品"))]),j]),t("div",z,[t("div",q,[t("div",G,[t("div",H,[t("div",J,[K,r(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.tempProduct.imageUrl=o),type:"text",class:"form-control",placeholder:"請輸入圖片網址"},null,512),[[u,s.tempProduct.imageUrl]])]),t("img",{class:"img-fluid",src:s.tempProduct.imageUrl,alt:""},null,8,O)]),t("div",null,[Q,R,Array.isArray(s.tempProduct.imagesUrl)?(i(),d("div",W,[(i(!0),d(g,null,P(s.tempProduct.imagesUrl,(o,m)=>(i(),d(g,{key:m+123},[r(t("input",{class:"form-control mb-2",type:"text","onUpdate:modelValue":b=>s.tempProduct.imagesUrl[m]=b},null,8,X),[[u,s.tempProduct.imagesUrl[m]]]),t("img",{src:s.tempProduct.imagesUrl[m],alt:"",class:"img-fluid mb-2"},null,8,Y),Z],64))),128)),!s.tempProduct.imagesUrl.length||s.tempProduct.imagesUrl[s.tempProduct.imagesUrl.length-1]?(i(),d("button",{key:0,class:"btn btn-outline-primary w-100 mb-1",onClick:e[1]||(e[1]=o=>s.tempProduct.imagesUrl.push(""))}," 新增圖片 ")):(i(),d("button",{key:1,class:"btn btn-outline-danger w-100 mb-2",onClick:e[2]||(e[2]=o=>s.tempProduct.imagesUrl.pop(""))}," 刪除圖片 "))])):C("",!0)])]),t("div",tt,[t("div",et,[st,r(t("input",{"onUpdate:modelValue":e[3]||(e[3]=o=>s.tempProduct.title=o),id:"title",class:"form-control",type:"text",placeholder:"請輸入標題"},null,512),[[u,s.tempProduct.title]])]),t("div",ot,[t("div",lt,[it,r(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.tempProduct.category=o),id:"category",type:"text",class:"form-control",placeholder:"請輸入分類"},null,512),[[u,s.tempProduct.category]])]),t("div",dt,[at,r(t("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>s.tempProduct.unit=o),id:"unit",type:"text",class:"form-control",placeholder:"請輸入單位"},null,512),[[u,s.tempProduct.unit]])])]),t("div",nt,[t("div",ct,[rt,r(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.tempProduct.origin_price=o),id:"origin_price",min:"0",type:"number",class:"form-control",placeholder:"請輸入價格"},null,512),[[u,s.tempProduct.origin_price]])]),t("div",ut,[mt,r(t("input",{"onUpdate:modelValue":e[7]||(e[7]=o=>s.tempProduct.price=o),id:"price",min:"0",type:"number",class:"form-control",placeholder:"請輸入售價"},null,512),[[u,s.tempProduct.price]])])]),ht,t("div",pt,[t("div",_t,[r(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>s.tempProduct.is_enabled=o),id:"is_enabled",class:"form-check-input me-2",type:"checkbox","true-value":1,"false-value":0},null,512),[[L,s.tempProduct.is_enabled]]),bt])])])])]),t("div",gt,[ft,t("button",{type:"button",class:"btn btn-danger",onClick:e[9]||(e[9]=o=>l.$emit("update-product",s.tempProduct))},"確認")])])])],512)])}const Pt=v(S,[["render",vt]]);const yt={components:{Pagination:V,ProductModal:Pt,DeletaModal:U,ToastMessages:k},data(){return{products:[],tempProduct:{imagesUrl:[]},isNew:!1,page:{},isLoading:!1,showToast:!1,title:"",message:""}},methods:{getProducts(l=1){const e=`https://vue3-course-api.hexschool.io/v2/api/asher_api/admin/products/?page=${l}`;this.isLoading=!0,this.$http.get(e).then(s=>{this.products=s.data.products,this.page=s.data.pagination,this.isLoading=!1}).catch(()=>{console.log("err")})},openModal(l,e){l==="create"?(this.productModal.show(),this.isNew=!0,this.tempProduct={imagesUrl:[]}):l==="edit"?(this.productModal.show(),this.isNew=!1,this.tempProduct={...e}):l==="delete"&&(this.deleteModal.show(),this.tempProduct={...e})},toastShow(l,e,s){this.title=l,this.message=e,setTimeout(()=>{this.toastMessage.show()},700),setTimeout(()=>{this.toastMessage.hide()},s)},updateProduct(){let l="https://vue3-course-api.hexschool.io/v2/api/asher_api/admin/product",e="post";this.isNew||(l=`https://vue3-course-api.hexschool.io/v2/api/asher_api/admin/product/${this.tempProduct.id}`,e="put"),this.$http[e](l,{data:this.tempProduct}).then(()=>{this.productModal.hide(),this.getProducts(),this.isNew===!1?this.toastShow("提示訊息","編輯產品成功",3e3):this.isNew===!0&&(this.isLoading=!0,this.toastShow("提示訊息","新增商品成功",3e3))}).catch(()=>{this.isNew===!1?this.toastShow("提示訊息","編輯產品錯誤",3e3):this.isNew===!0&&this.toastShow("提示訊息","新增商品錯誤",3e3)})},deleteProduct(){const l=`https://vue3-course-api.hexschool.io/v2/api/asher_api/admin/product/${this.tempProduct.id}`;this.$http.delete(l).then(()=>{this.toastShow("提示訊息","刪除產品成功",3e3),this.getProducts(),this.deleteModal.hide()}).catch(()=>{this.toastShow("提示訊息","刪除產品失敗",3e3)})}},mounted(){this.getProducts(),this.productModal=new f("#productModal"),this.deleteModal=new f("#deleteModal"),this.toastMessage=new N("#toastMessage")}},wt={class:"container page-container"},Mt={class:"products mt-4"},xt=t("h4",{class:"text-fz"}," 商品列表 ",-1),Ut=t("hr",null,null,-1),kt={class:"text-end"},Nt=t("p",{class:"text-center mx-"},"新增商品",-1),Vt=[Nt],Ct={class:"table mt-3"},Lt=t("thead",null,[t("tr",{class:"table-block text-white",style:{background:"#282828"}},[t("th",{width:"120"},"類別"),t("th",null,"商品名稱"),t("th",{width:"120"},"原價"),t("th",{width:"120"},"售價"),t("th",{width:"120"},"商品狀態"),t("th",{width:"120"},"編輯")])],-1),Dt={class:"text-secondary"},St={class:"fw-bolder"},Tt={key:0,class:"text-success"},$t={key:1},At={class:"btn-group"},Bt=["onClick"],Et=["onClick"];function Ft(l,e,s,y,a,c){const o=h("Loading"),m=h("pagination"),b=h("ProductModal"),w=h("DeletaModal"),M=h("ToastMessages");return i(),d("div",wt,[p(o,{active:a.isLoading,class:"vld-overlay"},null,8,["active"]),t("div",Mt,[xt,Ut,t("div",kt,[t("button",{class:"text-end btn btn-danger",type:"button",onClick:e[0]||(e[0]=n=>c.openModal("create"))},Vt)]),t("table",Ct,[Lt,t("tbody",null,[(i(!0),d(g,null,P(a.products,n=>(i(),d("tr",{key:n.id},[t("td",null,_(n.category),1),t("td",null,_(n.title),1),t("td",Dt,_(l.$filters.currency(n.origin_price)),1),t("td",St,_(l.$filters.currency(n.price)),1),t("td",null,[n.is_enabled?(i(),d("span",Tt,"啟用")):(i(),d("span",$t,"未啟用"))]),t("div",At,[t("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:x=>c.openModal("edit",n)}," 編輯",8,Bt),t("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:x=>c.openModal("delete",n)}," 刪除",8,Et)])]))),128))])])]),p(m,{pages:a.page,"get-products":c.getProducts,onEmitPages:c.getProducts},null,8,["pages","get-products","onEmitPages"]),p(b,{"is-new":a.isNew,"temp-product":a.tempProduct,onUpdateProduct:c.updateProduct,product:a.tempProduct},null,8,["is-new","temp-product","onUpdateProduct","product"]),p(w,{item:a.tempProduct,onDeleteItem:c.deleteProduct},null,8,["item","onDeleteItem"]),p(M,{title:a.title,message:a.message},null,8,["title","message"])])}const qt=v(yt,[["render",Ft]]);export{qt as default};
